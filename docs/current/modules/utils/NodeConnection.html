<!DOCTYPE html>
<html lang="en">
  <head>
    <title>NodeConnection -  API</title>
    <link rel="stylesheet" href="../../assets/css/bootstrap.css">
    <link rel="stylesheet" href="../../assets/css/typeahead.js-bootstrap.css">
    <link rel="stylesheet" href="../../assets/css/font-awesome.css">
    <link rel="stylesheet" href="../../assets/css/prism.css">
    <link rel="stylesheet" href="../../assets/css/main.css">
    <!--[if IE 7]>
    <link rel="stylesheet" href="../assets/css/font-awesome-ie7.css">
    <![endif]-->
    <script type="text/javascript" src="../../assets/js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="../../assets/js/bootstrap.js"></script>
    <script type="text/javascript" src="../../assets/js/typeahead.js"></script>
    <script type="text/javascript" src="../../assets/js/main.js"></script>
    <script src="http://use.edgefonts.net/source-sans-pro:n3,i3,n4,i4;source-code-pro.js"></script>

    <!-- Control the Flash of Unstyled Text (or FOUT) -->
    <style type="text/css">
        .wf-loading h1, .wf-loading h2, .wf-loading h3, .wf-loading h4,
        .wf-loading h5, .wf-loading h6, .wf-loading p, .wf-loading a {
            visibility: hidden;
        }
    </style>
    
    <script>
      window.moduleLevel = "../..";
    </script>
  </head>
  
  <body>
    <div class="row-fluid">
      <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <a class="brand" href="../../index.html"> API</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li><a href="#dependencies">Dependencies</a></li>
                <li><a href="#variables">Variables</a></li>
                <li><a href="#functions">Functions</a></li>
                <li><a href="#classes">Classes</a></li>
              </ul>
            </div>
            <input class="typeahead" placeholder="Search..." type="text" >
          </div>
        </div>
      </div>    </div>
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="left-section">
            <h2 class="number-of-modules">Modules (145)</h2>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_"><i class="icon-folder-open"></i>[root]</a>
              </li>
            </ul>
            <ul id="package_" class="nav nav-list">
              <li><a href="../../modules/brackets.html">brackets</a></li>
              <li><a href="../../modules/dependencies.html">dependencies</a></li>
              <li><a href="../../modules/main.html">main</a></li>
              <li><a href="../../modules/strings.html">strings</a></li>
              <li><a href="../../modules/xorigin.html">xorigin</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_command"><i class="icon-folder-open"></i>command</a>
              </li>
            </ul>
            <ul id="package_command" class="nav nav-list">
              <li><a href="../../modules/command/CommandManager.html">CommandManager</a></li>
              <li><a href="../../modules/command/Commands.html">Commands</a></li>
              <li><a href="../../modules/command/DefaultMenus.html">DefaultMenus</a></li>
              <li><a href="../../modules/command/KeyBindingManager.html">KeyBindingManager</a></li>
              <li><a href="../../modules/command/Menus.html">Menus</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_document"><i class="icon-folder-open"></i>document</a>
              </li>
            </ul>
            <ul id="package_document" class="nav nav-list">
              <li><a href="../../modules/document/ChangedDocumentTracker.html">ChangedDocumentTracker</a></li>
              <li><a href="../../modules/document/Document.html">Document</a></li>
              <li><a href="../../modules/document/DocumentCommandHandlers.html">DocumentCommandHandlers</a></li>
              <li><a href="../../modules/document/DocumentManager.html">DocumentManager</a></li>
              <li><a href="../../modules/document/InMemoryFile.html">InMemoryFile</a></li>
              <li><a href="../../modules/document/TextRange.html">TextRange</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_editor"><i class="icon-folder-open"></i>editor</a>
              </li>
            </ul>
            <ul id="package_editor" class="nav nav-list">
              <li><a href="../../modules/editor/CodeHintList.html">CodeHintList</a></li>
              <li><a href="../../modules/editor/CodeHintManager.html">CodeHintManager</a></li>
              <li><a href="../../modules/editor/CSSInlineEditor.html">CSSInlineEditor</a></li>
              <li><a href="../../modules/editor/Editor.html">Editor</a></li>
              <li><a href="../../modules/editor/EditorCommandHandlers.html">EditorCommandHandlers</a></li>
              <li><a href="../../modules/editor/EditorManager.html">EditorManager</a></li>
              <li><a href="../../modules/editor/EditorOptionHandlers.html">EditorOptionHandlers</a></li>
              <li><a href="../../modules/editor/EditorStatusBar.html">EditorStatusBar</a></li>
              <li><a href="../../modules/editor/ImageViewer.html">ImageViewer</a></li>
              <li><a href="../../modules/editor/InlineTextEditor.html">InlineTextEditor</a></li>
              <li><a href="../../modules/editor/InlineWidget.html">InlineWidget</a></li>
              <li><a href="../../modules/editor/MultiRangeInlineEditor.html">MultiRangeInlineEditor</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_extensibility"><i class="icon-folder-open"></i>extensibility</a>
              </li>
            </ul>
            <ul id="package_extensibility" class="nav nav-list">
              <li><a href="../../modules/extensibility/ExtensionManager.html">ExtensionManager</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerDialog.html">ExtensionManagerDialog</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerView.html">ExtensionManagerView</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerViewModel.html">ExtensionManagerViewModel</a></li>
              <li><a href="../../modules/extensibility/InstallExtensionDialog.html">InstallExtensionDialog</a></li>
              <li><a href="../../modules/extensibility/Package.html">Package</a></li>
              <li><a href="../../modules/extensibility/registry_utils.html">registry_utils</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_file"><i class="icon-folder-open"></i>file</a>
              </li>
            </ul>
            <ul id="package_file" class="nav nav-list">
              <li><a href="../../modules/file/FileUtils.html">FileUtils</a></li>
              <li><a href="../../modules/file/NativeFileError.html">NativeFileError</a></li>
              <li><a href="../../modules/file/NativeFileSystem.html">NativeFileSystem</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem"><i class="icon-folder-open"></i>filesystem</a>
              </li>
            </ul>
            <ul id="package_filesystem" class="nav nav-list">
              <li><a href="../../modules/filesystem/Directory.html">Directory</a></li>
              <li><a href="../../modules/filesystem/File.html">File</a></li>
              <li><a href="../../modules/filesystem/FileIndex.html">FileIndex</a></li>
              <li><a href="../../modules/filesystem/FileSystem.html">FileSystem</a></li>
              <li><a href="../../modules/filesystem/FileSystemEntry.html">FileSystemEntry</a></li>
              <li><a href="../../modules/filesystem/FileSystemError.html">FileSystemError</a></li>
              <li><a href="../../modules/filesystem/FileSystemStats.html">FileSystemStats</a></li>
              <li><a href="../../modules/filesystem/WatchedRoot.html">WatchedRoot</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell"><i class="icon-folder-open"></i>filesystem&#x2F;impls&#x2F;appshell</a>
              </li>
            </ul>
            <ul id="package_filesystem_impls_appshell" class="nav nav-list">
              <li><a href="../../modules/filesystem/impls/appshell/AppshellFileSystem.html">AppshellFileSystem</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell_node"><i class="icon-folder-open"></i>filesystem&#x2F;impls&#x2F;appshell&#x2F;node</a>
              </li>
            </ul>
            <ul id="package_filesystem_impls_appshell_node" class="nav nav-list">
              <li><a href="../../modules/filesystem/impls/appshell/node/FileWatcherDomain.html">FileWatcherDomain</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_help"><i class="icon-folder-open"></i>help</a>
              </li>
            </ul>
            <ul id="package_help" class="nav nav-list">
              <li><a href="../../modules/help/HelpCommandHandlers.html">HelpCommandHandlers</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_language"><i class="icon-folder-open"></i>language</a>
              </li>
            </ul>
            <ul id="package_language" class="nav nav-list">
              <li><a href="../../modules/language/CodeInspection.html">CodeInspection</a></li>
              <li><a href="../../modules/language/CSSUtils.html">CSSUtils</a></li>
              <li><a href="../../modules/language/HTMLDOMDiff.html">HTMLDOMDiff</a></li>
              <li><a href="../../modules/language/HTMLInstrumentation.html">HTMLInstrumentation</a></li>
              <li><a href="../../modules/language/HTMLSimpleDOM.html">HTMLSimpleDOM</a></li>
              <li><a href="../../modules/language/HTMLTokenizer.html">HTMLTokenizer</a></li>
              <li><a href="../../modules/language/HTMLUtils.html">HTMLUtils</a></li>
              <li><a href="../../modules/language/JSUtils.html">JSUtils</a></li>
              <li><a href="../../modules/language/LanguageManager.html">LanguageManager</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Agents"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Agents</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Agents" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Agents/ConsoleAgent.html">ConsoleAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/CSSAgent.html">CSSAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMAgent.html">DOMAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMHelpers.html">DOMHelpers</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMNode.html">DOMNode</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/EditAgent.html">EditAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/GotoAgent.html">GotoAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/HighlightAgent.html">HighlightAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/NetworkAgent.html">NetworkAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/RemoteAgent.html">RemoteAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/RemoteFunctions.html">RemoteFunctions</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/ScriptAgent.html">ScriptAgent</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Documents"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Documents</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Documents" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Documents/CSSDocument.html">CSSDocument</a></li>
              <li><a href="../../modules/LiveDevelopment/Documents/HTMLDocument.html">HTMLDocument</a></li>
              <li><a href="../../modules/LiveDevelopment/Documents/JSDocument.html">JSDocument</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Inspector"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Inspector</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Inspector" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Inspector/Inspector.html">Inspector</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment"><i class="icon-folder-open"></i>LiveDevelopment</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/LiveDevelopment.html">LiveDevelopment</a></li>
              <li><a href="../../modules/LiveDevelopment/LiveDevServerManager.html">LiveDevServerManager</a></li>
              <li><a href="../../modules/LiveDevelopment/main.html">main</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Servers"><i class="icon-folder-open"></i>LiveDevelopment&#x2F;Servers</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Servers" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Servers/BaseServer.html">BaseServer</a></li>
              <li><a href="../../modules/LiveDevelopment/Servers/FileServer.html">FileServer</a></li>
              <li><a href="../../modules/LiveDevelopment/Servers/UserServer.html">UserServer</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_preferences"><i class="icon-folder-open"></i>preferences</a>
              </li>
            </ul>
            <ul id="package_preferences" class="nav nav-list">
              <li><a href="../../modules/preferences/PreferencesBase.html">PreferencesBase</a></li>
              <li><a href="../../modules/preferences/PreferencesDialogs.html">PreferencesDialogs</a></li>
              <li><a href="../../modules/preferences/PreferencesImpl.html">PreferencesImpl</a></li>
              <li><a href="../../modules/preferences/PreferencesManager.html">PreferencesManager</a></li>
              <li><a href="../../modules/preferences/PreferenceStorage.html">PreferenceStorage</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_project"><i class="icon-folder-open"></i>project</a>
              </li>
            </ul>
            <ul id="package_project" class="nav nav-list">
              <li><a href="../../modules/project/FileIndexManager.html">FileIndexManager</a></li>
              <li><a href="../../modules/project/FileSyncManager.html">FileSyncManager</a></li>
              <li><a href="../../modules/project/FileViewController.html">FileViewController</a></li>
              <li><a href="../../modules/project/ProjectManager.html">ProjectManager</a></li>
              <li><a href="../../modules/project/SidebarView.html">SidebarView</a></li>
              <li><a href="../../modules/project/WorkingSetSort.html">WorkingSetSort</a></li>
              <li><a href="../../modules/project/WorkingSetView.html">WorkingSetView</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_search"><i class="icon-folder-open"></i>search</a>
              </li>
            </ul>
            <ul id="package_search" class="nav nav-list">
              <li><a href="../../modules/search/FileFilters.html">FileFilters</a></li>
              <li><a href="../../modules/search/FindBar.html">FindBar</a></li>
              <li><a href="../../modules/search/FindInFiles.html">FindInFiles</a></li>
              <li><a href="../../modules/search/FindInFilesUI.html">FindInFilesUI</a></li>
              <li><a href="../../modules/search/FindReplace.html">FindReplace</a></li>
              <li><a href="../../modules/search/FindUtils.html">FindUtils</a></li>
              <li><a href="../../modules/search/QuickOpen.html">QuickOpen</a></li>
              <li><a href="../../modules/search/ScrollTrackMarkers.html">ScrollTrackMarkers</a></li>
              <li><a href="../../modules/search/SearchModel.html">SearchModel</a></li>
              <li><a href="../../modules/search/SearchResultsView.html">SearchResultsView</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_utils"><i class="icon-folder-open"></i>utils</a>
              </li>
            </ul>
            <ul id="package_utils" class="nav nav-list">
              <li><a href="../../modules/utils/AnimationUtils.html">AnimationUtils</a></li>
              <li><a href="../../modules/utils/AppInit.html">AppInit</a></li>
              <li><a href="../../modules/utils/Async.html">Async</a></li>
              <li><a href="../../modules/utils/BuildInfoUtils.html">BuildInfoUtils</a></li>
              <li><a href="../../modules/utils/CollectionUtils.html">CollectionUtils</a></li>
              <li><a href="../../modules/utils/ColorUtils.html">ColorUtils</a></li>
              <li><a href="../../modules/utils/DeprecationWarning.html">DeprecationWarning</a></li>
              <li><a href="../../modules/utils/DragAndDrop.html">DragAndDrop</a></li>
              <li><a href="../../modules/utils/DropdownEventHandler.html">DropdownEventHandler</a></li>
              <li><a href="../../modules/utils/ExtensionLoader.html">ExtensionLoader</a></li>
              <li><a href="../../modules/utils/ExtensionUtils.html">ExtensionUtils</a></li>
              <li><a href="../../modules/utils/Global.html">Global</a></li>
              <li><a href="../../modules/utils/KeyEvent.html">KeyEvent</a></li>
              <li><a href="../../modules/utils/NativeApp.html">NativeApp</a></li>
              <li><a href="../../modules/utils/NodeConnection.html">NodeConnection</a></li>
              <li><a href="../../modules/utils/NodeDomain.html">NodeDomain</a></li>
              <li><a href="../../modules/utils/PerfUtils.html">PerfUtils</a></li>
              <li><a href="../../modules/utils/Resizer.html">Resizer</a></li>
              <li><a href="../../modules/utils/ShellAPI.html">ShellAPI</a></li>
              <li><a href="../../modules/utils/StringMatch.html">StringMatch</a></li>
              <li><a href="../../modules/utils/StringUtils.html">StringUtils</a></li>
              <li><a href="../../modules/utils/TokenUtils.html">TokenUtils</a></li>
              <li><a href="../../modules/utils/UpdateNotification.html">UpdateNotification</a></li>
              <li><a href="../../modules/utils/UrlParams.html">UrlParams</a></li>
              <li><a href="../../modules/utils/ValidationUtils.html">ValidationUtils</a></li>
              <li><a href="../../modules/utils/ViewUtils.html">ViewUtils</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_view"><i class="icon-folder-open"></i>view</a>
              </li>
            </ul>
            <ul id="package_view" class="nav nav-list">
              <li><a href="../../modules/view/PanelManager.html">PanelManager</a></li>
              <li><a href="../../modules/view/ViewCommandHandlers.html">ViewCommandHandlers</a></li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_widgets"><i class="icon-folder-open"></i>widgets</a>
              </li>
            </ul>
            <ul id="package_widgets" class="nav nav-list">
              <li><a href="../../modules/widgets/bootstrap-alerts.html">bootstrap-alerts</a></li>
              <li><a href="../../modules/widgets/bootstrap-button.html">bootstrap-button</a></li>
              <li><a href="../../modules/widgets/bootstrap-dropdown.html">bootstrap-dropdown</a></li>
              <li><a href="../../modules/widgets/bootstrap-modal.html">bootstrap-modal</a></li>
              <li><a href="../../modules/widgets/bootstrap-popover.html">bootstrap-popover</a></li>
              <li><a href="../../modules/widgets/bootstrap-scrollspy.html">bootstrap-scrollspy</a></li>
              <li><a href="../../modules/widgets/bootstrap-tab.html">bootstrap-tab</a></li>
              <li><a href="../../modules/widgets/bootstrap-tooltip.html">bootstrap-tooltip</a></li>
              <li><a href="../../modules/widgets/bootstrap-twipsy-mod.html">bootstrap-twipsy-mod</a></li>
              <li><a href="../../modules/widgets/DefaultDialogs.html">DefaultDialogs</a></li>
              <li><a href="../../modules/widgets/Dialogs.html">Dialogs</a></li>
              <li><a href="../../modules/widgets/DropdownButton.html">DropdownButton</a></li>
              <li><a href="../../modules/widgets/ModalBar.html">ModalBar</a></li>
              <li><a href="../../modules/widgets/PopUpManager.html">PopUpManager</a></li>
              <li><a href="../../modules/widgets/StatusBar.html">StatusBar</a></li>
            </ul>
          </div>
        </div>
        <div class="module span9">
<h1>NodeConnection</h1>


<section class="description">
    <h3>Description</h3>
    
    <div></div>
</section>

<section id="dependencies">
    <h3>Dependencies</h3>


    <span class="alert alert-info">This module has no dependencies</span>
</section>
<section id="variables">
    
    <h3>Variables 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>    </h3>

<div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>CONNECTION_ATTEMPTS</h4>

    
<dl>
    <dt>Type</dt>
    <dd>number</dd>
</dl>
    <div class="description"><p>Connection attempts to make before failing</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    var CONNECTION_ATTEMPTS = 10;</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>CONNECTION_TIMEOUT</h4>

    
<dl>
    <dt>Type</dt>
    <dd>number</dd>
</dl>
    <div class="description"><p>Milliseconds to wait before a particular connection attempt is considered failed.
NOTE: It&#39;s okay for the connection timeout to be long because the
expected behavior of WebSockets is to send a &quot;close&quot; event as soon
as they realize they can&#39;t connect. So, we should rarely hit the
connection timeout even if we try to connect to a port that isn&#39;t open.</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    var CONNECTION_TIMEOUT  = 10000; &#x2F;&#x2F; 10 seconds</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>MAX_COUNTER_VALUE</h4>

    
<dl>
    <dt>Type</dt>
    <dd>number</dd>
</dl>
    <div class="description"><p>Maximum value of the command ID counter</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    var MAX_COUNTER_VALUE = 4294967295; &#x2F;&#x2F; 2^32 - 1</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>RETRY_DELAY</h4>

    
<dl>
    <dt>Type</dt>
    <dd>number</dd>
</dl>
    <div class="description"><p>Milliseconds to wait before retrying connecting</p>
</div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    var RETRY_DELAY         = 500;   &#x2F;&#x2F; 1&#x2F;2 second</code></pre></div>
</section>

<section id="functions">

    <h3>Functions 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>    </h3>

<div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>attemptSingleConnect</h4>

    
    <div class="description"></div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    function attemptSingleConnect() {
        var deferred = $.Deferred();
        var port = null;
        var ws = null;
        setDeferredTimeout(deferred, CONNECTION_TIMEOUT);
        
        brackets.app.getNodeState(function (err, nodePort) {
            if (!err &amp;&amp; nodePort &amp;&amp; deferred.state() !== &quot;rejected&quot;) {
                port = nodePort;
                ws = new WebSocket(&quot;ws:&#x2F;&#x2F;localhost:&quot; + port);
                
                &#x2F;&#x2F; Expect ArrayBuffer objects from Node when receiving binary
                &#x2F;&#x2F; data instead of DOM Blobs, which are the default.
                ws.binaryType = &quot;arraybuffer&quot;;
                
                &#x2F;&#x2F; If the server port isn&#39;t open, we get a close event
                &#x2F;&#x2F; at some point in the future (and will not get an onopen 
                &#x2F;&#x2F; event)
                ws.onclose = function () {
                    deferred.reject(&quot;WebSocket closed&quot;);
                };

                ws.onopen = function () {
                    &#x2F;&#x2F; If we successfully opened, remove the old onclose 
                    &#x2F;&#x2F; handler (which was present to detect failure to 
                    &#x2F;&#x2F; connect at all).
                    ws.onclose = null;
                    deferred.resolveWith(null, [ws, port]);
                };
            } else {
                deferred.reject(&quot;brackets.app.getNodeState error: &quot; + err);
            }
        });
        
        return deferred.promise();
    }</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>setDeferredTimeout</h4>

    
    <div class="description"></div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    function setDeferredTimeout(deferred, delay) {
        var timer = setTimeout(function () {
            deferred.reject(&quot;timeout&quot;);
        }, delay);
        deferred.always(function () { clearTimeout(timer); });
    }</code></pre></div>
</section>

<section id="classes">
    
    <h2>Classes</h2>

    <div class="well">
        <div class="member public">
            
            <span class="pull-right scope">Constructor</span>
            
            <h4>NodeConnection</h4>
            <em><p>Provides an interface for interacting with the node server.</p>
</em>
            
            <dl>
            </dl>

            <button class="btn btn-small show-code">Show code</button>
            <pre class="code language-javascript"><code class="language-javascript">    function NodeConnection() {
        this.domains = {};
        this._registeredModules = [];
        this._pendingInterfaceRefreshDeferreds = [];
        this._pendingCommandDeferreds = [];
    }</code></pre>
        </div>
        
        <section class="properties ">

            <h3>Properties 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>            </h3>

<div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_autoReconnect</h4>

    
<dl>
    <dt>Type</dt>
    <dd>boolean</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._autoReconnect = false;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_commandCount</h4>

    
<dl>
    <dt>Type</dt>
    <dd>number</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._commandCount = 1;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_pendingCommandDeferreds</h4>

    
<dl>
    <dt>Type</dt>
    <dd>Array.&lt;jQuery.Deferred&gt;</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._pendingCommandDeferreds = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_pendingInterfaceRefreshDeferreds</h4>

    
<dl>
    <dt>Type</dt>
    <dd>Array.&lt;jQuery.Deferred&gt;</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._pendingInterfaceRefreshDeferreds = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_port</h4>

    
<dl>
    <dt>Type</dt>
    <dd>?number</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._port = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_registeredModules</h4>

    
<dl>
    <dt>Type</dt>
    <dd>Array.&lt;string&gt;</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._registeredModules = null;</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_ws</h4>

    
<dl>
    <dt>Type</dt>
    <dd>WebSocket</dd>
    <dt>Private</dt>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._ws = null;</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>domains</h4>

    
<dl>
    <dt>Type</dt>
    <dd>Object</dd>
</dl>
    <div class="description"></div>

<button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype.domains = null;</code></pre></div>
        </section>

        <section class="methods">

            <h3>Methods 
<label class="checkbox">
    <input class="toggle-public" type="checkbox"> Show Private Members
</label>            </h3>

<div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_cleanup</h4>

    
    <div class="description"></div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._cleanup = function () {
        &#x2F;&#x2F; clear out the domains, since we may get different ones
        &#x2F;&#x2F; on the next connection
        this.domains = {};
        
        &#x2F;&#x2F; shut down the old connection if there is one
        if (this._ws &amp;&amp; this._ws.readyState !== WebSocket.CLOSED) {
            try {
                this._ws.close();
            } catch (e) { }
        }
        var failedDeferreds = this._pendingInterfaceRefreshDeferreds
            .concat(this._pendingCommandDeferreds);
        failedDeferreds.forEach(function (d) {
            d.reject(&quot;cleanup&quot;);
        });
        this._pendingInterfaceRefreshDeferreds = [];
        this._pendingCommandDeferreds = [];
        
        this._ws = null;
        this._port = null;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_getNextCommandID</h4>

    
    <div class="description"></div>
    
<dl>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">number</dd>
    <dd>The next command ID to use. Always representable as an unsigned 32-bit integer.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._getNextCommandID = function () {
        var nextID;
        
        if (this._commandCount &gt; MAX_COUNTER_VALUE) {
            nextID = this._commandCount = 0;
        } else {
            nextID = this._commandCount++;
        }
        
        return nextID;
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_receive</h4>

    
    <div class="description"></div>
    
<dl>
    <dt>message</dt>
    <dd class="label label-info pull-left">WebSocket.Message</dd>
    <dd>Message object from WebSocket</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._receive = function (message) {
        var responseDeferred = null;
        var data = message.data;
        var m;
        
        if (message.data instanceof ArrayBuffer) {
            &#x2F;&#x2F; The first four bytes encode the command ID as an unsigned 32-bit integer
            if (data.byteLength &lt; 4) {
                console.error(&quot;[NodeConnection] received malformed binary message&quot;);
                return;
            }
            
            var header = data.slice(0, 4),
                body = data.slice(4),
                headerView = new Uint32Array(header),
                id = headerView[0];
            
            &#x2F;&#x2F; Unpack the binary message into a commandResponse
            m = {
                type: &quot;commandResponse&quot;,
                message: {
                    id: id,
                    response: body
                }
            };
        } else {
            try {
                m = JSON.parse(data);
            } catch (e) {
                console.error(&quot;[NodeConnection] received malformed message&quot;, message, e.message);
                return;
            }
        }
        
        switch (m.type) {
        case &quot;event&quot;:
            var $this = $(this);

            if (m.message.domain === &quot;base&quot; &amp;&amp; m.message.event === &quot;newDomains&quot;) {
                this._refreshInterface();
            }
            
            &#x2F;&#x2F; Event type for backwards compatibility for original design: &quot;domain.event&quot;
            $this.triggerHandler(m.message.domain + &quot;.&quot; + m.message.event,
                                   m.message.parameters);

            &#x2F;&#x2F; Event type &quot;domain:event&quot;
            $this.triggerHandler(m.message.domain + &quot;:&quot; + m.message.event,
                                   m.message.parameters);
            break;
        case &quot;commandResponse&quot;:
            responseDeferred = this._pendingCommandDeferreds[m.message.id];
            if (responseDeferred) {
                responseDeferred.resolveWith(this, [m.message.response]);
                delete this._pendingCommandDeferreds[m.message.id];
            }
            break;
        case &quot;commandError&quot;:
            responseDeferred = this._pendingCommandDeferreds[m.message.id];
            if (responseDeferred) {
                responseDeferred.rejectWith(
                    this,
                    [m.message.message, m.message.stack]
                );
                delete this._pendingCommandDeferreds[m.message.id];
            }
            break;
        case &quot;error&quot;:
            console.error(&quot;[NodeConnection] received error: &quot; +
                            m.message.message);
            break;
        default:
            console.error(&quot;[NodeConnection] unknown event type: &quot; + m.type);
        }
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_refreshInterface</h4>

    
    <div class="description"></div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._refreshInterface = function () {
        var deferred = $.Deferred();
        var self = this;
        
        var pendingDeferreds = this._pendingInterfaceRefreshDeferreds;
        this._pendingInterfaceRefreshDeferreds = [];
        deferred.then(
            function () {
                pendingDeferreds.forEach(function (d) { d.resolve(); });
            },
            function (err) {
                pendingDeferreds.forEach(function (d) { d.reject(err); });
            }
        );
        
        function refreshInterfaceCallback(spec) {
            function makeCommandFunction(domainName, commandSpec) {
                return function () {
                    var deferred = $.Deferred();
                    var parameters = Array.prototype.slice.call(arguments, 0);
                    var id = self._getNextCommandID();
                    self._pendingCommandDeferreds[id] = deferred;
                    self._send({id: id,
                               domain: domainName,
                               command: commandSpec.name,
                               parameters: parameters
                               });
                    return deferred;
                };
            }
            
            &#x2F;&#x2F; TODO: Don&#39;t replace the domain object every time. Instead, merge.
            self.domains = {};
            self.domainEvents = {};
            spec.forEach(function (domainSpec) {
                self.domains[domainSpec.domain] = {};
                domainSpec.commands.forEach(function (commandSpec) {
                    self.domains[domainSpec.domain][commandSpec.name] =
                        makeCommandFunction(domainSpec.domain, commandSpec);
                });
                self.domainEvents[domainSpec.domain] = {};
                domainSpec.events.forEach(function (eventSpec) {
                    var parameters = eventSpec.parameters;
                    self.domainEvents[domainSpec.domain][eventSpec.name] = parameters;
                });
            });
            deferred.resolve();
        }
        
        if (this.connected()) {
            $.getJSON(&quot;http:&#x2F;&#x2F;localhost:&quot; + this._port + &quot;&#x2F;api&quot;)
                .done(refreshInterfaceCallback)
                .fail(function (err) { deferred.reject(err); });
        } else {
            deferred.reject(&quot;Attempted to call _refreshInterface when not connected.&quot;);
        }
        
        return deferred.promise();
    };</code></pre></div><div class="member private">

<span class="pull-right scope">
    Private
    
</span>
    <h4>_send</h4>

    
    <div class="description"></div>
    
<dl>
    <dt>m</dt>
    <dd class="label label-info pull-left">Object,string</dd>
    <dd>Object to send. Must be JSON.stringify-able.</dd>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype._send = function (m) {
        if (this.connected()) {

            &#x2F;&#x2F; Convert the message to a string
            var messageString = null;
            if (typeof m === &quot;string&quot;) {
                messageString = m;
            } else {
                try {
                    messageString = JSON.stringify(m);
                } catch (stringifyError) {
                    console.error(&quot;[NodeConnection] Unable to stringify message in order to send: &quot; + stringifyError.message);
                }
            }
            
            &#x2F;&#x2F; If we succeded in making a string, try to send it
            if (messageString) {
                try {
                    this._ws.send(messageString);
                } catch (sendError) {
                    console.error(&quot;[NodeConnection] Error sending message: &quot; + sendError.message);
                }
            }
        } else {
            console.error(&quot;[NodeConnection] Not connected to node, unable to send.&quot;);
        }
    };</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>connect</h4>

    
    <div class="description"><p>Connect to the node server. After connecting, the NodeConnection
object will trigger a &quot;close&quot; event when the underlying socket
is closed. If the connection is set to autoReconnect, then the
event will also include a jQuery promise for the connection.</p>
</div>
    
<dl>
    <dt>autoReconnect</dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd>Whether to automatically try to reconnect to the server if the connection succeeds and then later disconnects. Note if this connection fails initially, the autoReconnect flag is set to false. Future calls to connect() can reset it to true</dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">jQuery.Promise</dd>
    <dd>Promise that resolves/rejects when the connection succeeds/fails</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype.connect = function (autoReconnect) {
        var self = this;
        self._autoReconnect = autoReconnect;
        var deferred = $.Deferred();
        var attemptCount = 0;
        var attemptTimestamp = null;
        
        &#x2F;&#x2F; Called after a successful connection to do final setup steps
        function registerHandlersAndDomains(ws, port) {
            &#x2F;&#x2F; Called if we succeed at the final setup
            function success() {
                self._ws.onclose = function () {
                    if (self._autoReconnect) {
                        var $promise = self.connect(true);
                        $(self).triggerHandler(&quot;close&quot;, [$promise]);
                    } else {
                        self._cleanup();
                        $(self).triggerHandler(&quot;close&quot;);
                    }
                };
                deferred.resolve();
            }
            &#x2F;&#x2F; Called if we fail at the final setup
            function fail(err) {
                self._cleanup();
                deferred.reject(err);
            }
            
            self._ws = ws;
            self._port = port;
            self._ws.onmessage = self._receive.bind(self);
            
            &#x2F;&#x2F; refresh the current domains, then re-register any
            &#x2F;&#x2F; &quot;autoregister&quot; modules
            self._refreshInterface().then(
                function () {
                    if (self._registeredModules.length &gt; 0) {
                        self.loadDomains(self._registeredModules, false).then(
                            success,
                            fail
                        );
                    } else {
                        success();
                    }
                },
                fail
            );
        }
        
        &#x2F;&#x2F; Repeatedly tries to connect until we succeed or until we&#39;ve
        &#x2F;&#x2F; failed CONNECTION_ATTEMPT times. After each attempt, waits
        &#x2F;&#x2F; at least RETRY_DELAY before trying again.
        function doConnect() {
            attemptCount++;
            attemptTimestamp = new Date();
            attemptSingleConnect().then(
                registerHandlersAndDomains, &#x2F;&#x2F; succeded
                function () { &#x2F;&#x2F; failed this attempt, possibly try again
                    if (attemptCount &lt; CONNECTION_ATTEMPTS) { &#x2F;&#x2F;try again
                        &#x2F;&#x2F; Calculate how long we should wait before trying again
                        var now = new Date();
                        var delay = Math.max(
                            RETRY_DELAY - (now - attemptTimestamp),
                            1
                        );
                        setTimeout(doConnect, delay);
                    } else { &#x2F;&#x2F; too many attempts, give up
                        deferred.reject(&quot;Max connection attempts reached&quot;);
                    }
                }
            );
        }
        
        &#x2F;&#x2F; Start the connection process
        self._cleanup();
        doConnect();

        return deferred.promise();
    };</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>connected</h4>

    
    <div class="description"><p>Determines whether the NodeConnection is currently connected</p>
</div>
    
<dl>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd>Whether the NodeConnection is connected.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype.connected = function () {
        return !!(this._ws &amp;&amp; this._ws.readyState === WebSocket.OPEN);
    };</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>disconnect</h4>

    
    <div class="description"><p>Explicitly disconnects from the server. Note that even if
autoReconnect was set to true at connection time, the connection
will not reconnect after this call. Reconnection can be manually done
by calling connect() again.</p>
</div>
    
<dl>
</dl><dl>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype.disconnect = function () {
        this._autoReconnect = false;
        this._cleanup();
    };</code></pre></div><div class="member">

<span class="pull-right scope">
    
    
</span>
    <h4>loadDomains</h4>

    
    <div class="description"><p>Load domains into the server by path</p>
</div>
    
<dl>
    <dt>List</dt>
    <dd class="label label-info pull-left">Array.&lt;string&gt;</dd>
    <dd>of absolute paths to load</dd>
    <dt>autoReload</dt>
    <dd class="label label-info pull-left">boolean</dd>
    <dd>Whether to auto-reload the domains if the server fails and restarts. Note that the reload is initiated by the client, so it will only happen after the client reconnects.</dd>
</dl><dl>
    <dt>Returns: </dt>
    <dd class="label label-info pull-left">jQuery.Promise</dd>
    <dd>Promise that resolves after the load has succeeded and the new API is availale at NodeConnection.domains, or that rejects on failure.</dd>
</dl><button class="btn btn-small show-code">Show code</button>
<pre class="code language-javascript"><code class="language-javascript">    NodeConnection.prototype.loadDomains = function (paths, autoReload) {
        var deferred = $.Deferred();
        setDeferredTimeout(deferred, CONNECTION_TIMEOUT);
        var pathArray = paths;
        if (!Array.isArray(paths)) {
            pathArray = [paths];
        }
        
        if (autoReload) {
            Array.prototype.push.apply(this._registeredModules, pathArray);
        }

        if (this.domains.base &amp;&amp; this.domains.base.loadDomainModulesFromPaths) {
            this.domains.base.loadDomainModulesFromPaths(pathArray).then(
                function (success) { &#x2F;&#x2F; command call succeeded
                    if (!success) {
                        &#x2F;&#x2F; response from commmand call was &quot;false&quot; so we know
                        &#x2F;&#x2F; the actual load failed.
                        deferred.reject(&quot;loadDomainModulesFromPaths failed&quot;);
                    }
                    &#x2F;&#x2F; if the load succeeded, we wait for the API refresh to
                    &#x2F;&#x2F; resolve the deferred.
                },
                function (reason) { &#x2F;&#x2F; command call failed
                    deferred.reject(&quot;Unable to load one of the modules: &quot; + pathArray + (reason ? &quot;, reason: &quot; + reason : &quot;&quot;));
                }
            );

            this._pendingInterfaceRefreshDeferreds.push(deferred);
        } else {
            deferred.reject(&quot;this.domains.base is undefined&quot;);
        }
        
        return deferred.promise();
    };</code></pre></div>
        </section>

    </div>

</section>
        </div>
      </div>
    </div>

    <script type="text/javascript" src="../../assets/js/prism.js"></script>
  </body>
</html>