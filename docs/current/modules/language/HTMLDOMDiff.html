<!DOCTYPE html>
<html lang="en">
  <head>
    <title></title>
    <link rel="stylesheet" href="../../assets/css/bootstrap.css">
    <link rel="stylesheet" href="../../assets/css/typeahead.js-bootstrap.css">
    <link rel="stylesheet" href="../../assets/css/font-awesome.css">
    <link rel="stylesheet" href="../../assets/css/prism.css">
    <link rel="stylesheet" href="../../assets/css/main.css">
    <!--[if IE 7]>
    <link rel="stylesheet" href="../assets/css/font-awesome-ie7.css">
    <![endif]-->
    <script type="text/javascript" src="../../assets/js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="../../assets/js/bootstrap.js"></script>
    <script type="text/javascript" src="../../assets/js/typeahead.js"></script>
    <script type="text/javascript" src="../../assets/js/main.js"></script>
    
    <script>
      window.moduleLevel = "../..";
    </script>
  </head>
  <body>
    <div class="row-fluid">
      <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <a class="brand" href="../../index.html"> API</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li><a href="#dependencies">Dependencies</a></li>
                <li><a href="#variables">Variables</a></li>
                <li><a href="#functions">Functions</a></li>
                <li><a href="#classes">Classes</a></li>
              </ul>
            </div>
            <input class="typeahead" placeholder="Search..." type="text" >
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">
          <div class="page-header">
            <h1>HTMLDOMDiff</h1>
          </div>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
          <div class="left-section">
            <ul class="nav nav-list">
              <li class="nav-header">
                <a href="#" id="toggle-other-modules"><i class="icon-folder-close"></i> Modules (140)</a>
              </li>
            </ul>
            <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_"><i class="icon-folder-open"></i></a>
              </li>
            </ul>
            <ul id="package_" class="nav nav-list">
              <li><a href="../../modules/brackets.html">brackets</a></li>
              <li><a href="../../modules/dependencies.html">dependencies</a></li>
              <li><a href="../../modules/main.html">main</a></li>
              <li><a href="../../modules/strings.html">strings</a></li>
              <li><a href="../../modules/xorigin.html">xorigin</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_command"><i class="icon-folder-open"></i>command</a>
              </li>
            </ul>
            <ul id="package_command" class="nav nav-list">
              <li><a href="../../modules/command/CommandManager.html">CommandManager</a></li>
              <li><a href="../../modules/command/Commands.html">Commands</a></li>
              <li><a href="../../modules/command/DefaultMenus.html">DefaultMenus</a></li>
              <li><a href="../../modules/command/KeyBindingManager.html">KeyBindingManager</a></li>
              <li><a href="../../modules/command/Menus.html">Menus</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_document"><i class="icon-folder-open"></i>document</a>
              </li>
            </ul>
            <ul id="package_document" class="nav nav-list">
              <li><a href="../../modules/document/ChangedDocumentTracker.html">ChangedDocumentTracker</a></li>
              <li><a href="../../modules/document/Document.html">Document</a></li>
              <li><a href="../../modules/document/DocumentCommandHandlers.html">DocumentCommandHandlers</a></li>
              <li><a href="../../modules/document/DocumentManager.html">DocumentManager</a></li>
              <li><a href="../../modules/document/InMemoryFile.html">InMemoryFile</a></li>
              <li><a href="../../modules/document/TextRange.html">TextRange</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_editor"><i class="icon-folder-open"></i>editor</a>
              </li>
            </ul>
            <ul id="package_editor" class="nav nav-list">
              <li><a href="../../modules/editor/CodeHintList.html">CodeHintList</a></li>
              <li><a href="../../modules/editor/CodeHintManager.html">CodeHintManager</a></li>
              <li><a href="../../modules/editor/CSSInlineEditor.html">CSSInlineEditor</a></li>
              <li><a href="../../modules/editor/Editor.html">Editor</a></li>
              <li><a href="../../modules/editor/EditorCommandHandlers.html">EditorCommandHandlers</a></li>
              <li><a href="../../modules/editor/EditorManager.html">EditorManager</a></li>
              <li><a href="../../modules/editor/EditorOptionHandlers.html">EditorOptionHandlers</a></li>
              <li><a href="../../modules/editor/EditorStatusBar.html">EditorStatusBar</a></li>
              <li><a href="../../modules/editor/ImageViewer.html">ImageViewer</a></li>
              <li><a href="../../modules/editor/InlineTextEditor.html">InlineTextEditor</a></li>
              <li><a href="../../modules/editor/InlineWidget.html">InlineWidget</a></li>
              <li><a href="../../modules/editor/MultiRangeInlineEditor.html">MultiRangeInlineEditor</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_extensibility"><i class="icon-folder-open"></i>extensibility</a>
              </li>
            </ul>
            <ul id="package_extensibility" class="nav nav-list">
              <li><a href="../../modules/extensibility/ExtensionManager.html">ExtensionManager</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerDialog.html">ExtensionManagerDialog</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerView.html">ExtensionManagerView</a></li>
              <li><a href="../../modules/extensibility/ExtensionManagerViewModel.html">ExtensionManagerViewModel</a></li>
              <li><a href="../../modules/extensibility/InstallExtensionDialog.html">InstallExtensionDialog</a></li>
              <li><a href="../../modules/extensibility/Package.html">Package</a></li>
              <li><a href="../../modules/extensibility/registry_utils.html">registry_utils</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_file"><i class="icon-folder-open"></i>file</a>
              </li>
            </ul>
            <ul id="package_file" class="nav nav-list">
              <li><a href="../../modules/file/FileUtils.html">FileUtils</a></li>
              <li><a href="../../modules/file/NativeFileError.html">NativeFileError</a></li>
              <li><a href="../../modules/file/NativeFileSystem.html">NativeFileSystem</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem"><i class="icon-folder-open"></i>filesystem</a>
              </li>
            </ul>
            <ul id="package_filesystem" class="nav nav-list">
              <li><a href="../../modules/filesystem/Directory.html">Directory</a></li>
              <li><a href="../../modules/filesystem/File.html">File</a></li>
              <li><a href="../../modules/filesystem/FileIndex.html">FileIndex</a></li>
              <li><a href="../../modules/filesystem/FileSystem.html">FileSystem</a></li>
              <li><a href="../../modules/filesystem/FileSystemEntry.html">FileSystemEntry</a></li>
              <li><a href="../../modules/filesystem/FileSystemError.html">FileSystemError</a></li>
              <li><a href="../../modules/filesystem/FileSystemStats.html">FileSystemStats</a></li>
              <li><a href="../../modules/filesystem/WatchedRoot.html">WatchedRoot</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell"><i class="icon-folder-open"></i>filesystem.impls.appshell</a>
              </li>
            </ul>
            <ul id="package_filesystem_impls_appshell" class="nav nav-list">
              <li><a href="../../modules/filesystem/impls/appshell/AppshellFileSystem.html">AppshellFileSystem</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_filesystem_impls_appshell_node"><i class="icon-folder-open"></i>filesystem.impls.appshell.node</a>
              </li>
            </ul>
            <ul id="package_filesystem_impls_appshell_node" class="nav nav-list">
              <li><a href="../../modules/filesystem/impls/appshell/node/FileWatcherDomain.html">FileWatcherDomain</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_help"><i class="icon-folder-open"></i>help</a>
              </li>
            </ul>
            <ul id="package_help" class="nav nav-list">
              <li><a href="../../modules/help/HelpCommandHandlers.html">HelpCommandHandlers</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_language"><i class="icon-folder-open"></i>language</a>
              </li>
            </ul>
            <ul id="package_language" class="nav nav-list">
              <li><a href="../../modules/language/CodeInspection.html">CodeInspection</a></li>
              <li><a href="../../modules/language/CSSUtils.html">CSSUtils</a></li>
              <li><a href="../../modules/language/HTMLDOMDiff.html">HTMLDOMDiff</a></li>
              <li><a href="../../modules/language/HTMLInstrumentation.html">HTMLInstrumentation</a></li>
              <li><a href="../../modules/language/HTMLSimpleDOM.html">HTMLSimpleDOM</a></li>
              <li><a href="../../modules/language/HTMLTokenizer.html">HTMLTokenizer</a></li>
              <li><a href="../../modules/language/HTMLUtils.html">HTMLUtils</a></li>
              <li><a href="../../modules/language/JSUtils.html">JSUtils</a></li>
              <li><a href="../../modules/language/LanguageManager.html">LanguageManager</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Agents"><i class="icon-folder-open"></i>LiveDevelopment.Agents</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Agents" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Agents/ConsoleAgent.html">ConsoleAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/CSSAgent.html">CSSAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMAgent.html">DOMAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMHelpers.html">DOMHelpers</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/DOMNode.html">DOMNode</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/EditAgent.html">EditAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/GotoAgent.html">GotoAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/HighlightAgent.html">HighlightAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/NetworkAgent.html">NetworkAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/RemoteAgent.html">RemoteAgent</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/RemoteFunctions.html">RemoteFunctions</a></li>
              <li><a href="../../modules/LiveDevelopment/Agents/ScriptAgent.html">ScriptAgent</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Documents"><i class="icon-folder-open"></i>LiveDevelopment.Documents</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Documents" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Documents/CSSDocument.html">CSSDocument</a></li>
              <li><a href="../../modules/LiveDevelopment/Documents/HTMLDocument.html">HTMLDocument</a></li>
              <li><a href="../../modules/LiveDevelopment/Documents/JSDocument.html">JSDocument</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Inspector"><i class="icon-folder-open"></i>LiveDevelopment.Inspector</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Inspector" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Inspector/Inspector.html">Inspector</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment"><i class="icon-folder-open"></i>LiveDevelopment</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/LiveDevelopment.html">LiveDevelopment</a></li>
              <li><a href="../../modules/LiveDevelopment/LiveDevServerManager.html">LiveDevServerManager</a></li>
              <li><a href="../../modules/LiveDevelopment/main.html">main</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_LiveDevelopment_Servers"><i class="icon-folder-open"></i>LiveDevelopment.Servers</a>
              </li>
            </ul>
            <ul id="package_LiveDevelopment_Servers" class="nav nav-list">
              <li><a href="../../modules/LiveDevelopment/Servers/BaseServer.html">BaseServer</a></li>
              <li><a href="../../modules/LiveDevelopment/Servers/FileServer.html">FileServer</a></li>
              <li><a href="../../modules/LiveDevelopment/Servers/UserServer.html">UserServer</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_preferences"><i class="icon-folder-open"></i>preferences</a>
              </li>
            </ul>
            <ul id="package_preferences" class="nav nav-list">
              <li><a href="../../modules/preferences/PreferencesBase.html">PreferencesBase</a></li>
              <li><a href="../../modules/preferences/PreferencesDialogs.html">PreferencesDialogs</a></li>
              <li><a href="../../modules/preferences/PreferencesImpl.html">PreferencesImpl</a></li>
              <li><a href="../../modules/preferences/PreferencesManager.html">PreferencesManager</a></li>
              <li><a href="../../modules/preferences/PreferenceStorage.html">PreferenceStorage</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_project"><i class="icon-folder-open"></i>project</a>
              </li>
            </ul>
            <ul id="package_project" class="nav nav-list">
              <li><a href="../../modules/project/FileIndexManager.html">FileIndexManager</a></li>
              <li><a href="../../modules/project/FileSyncManager.html">FileSyncManager</a></li>
              <li><a href="../../modules/project/FileViewController.html">FileViewController</a></li>
              <li><a href="../../modules/project/ProjectManager.html">ProjectManager</a></li>
              <li><a href="../../modules/project/SidebarView.html">SidebarView</a></li>
              <li><a href="../../modules/project/WorkingSetSort.html">WorkingSetSort</a></li>
              <li><a href="../../modules/project/WorkingSetView.html">WorkingSetView</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_search"><i class="icon-folder-open"></i>search</a>
              </li>
            </ul>
            <ul id="package_search" class="nav nav-list">
              <li><a href="../../modules/search/FileFilters.html">FileFilters</a></li>
              <li><a href="../../modules/search/FindInFiles.html">FindInFiles</a></li>
              <li><a href="../../modules/search/FindReplace.html">FindReplace</a></li>
              <li><a href="../../modules/search/QuickOpen.html">QuickOpen</a></li>
              <li><a href="../../modules/search/ScrollTrackMarkers.html">ScrollTrackMarkers</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_utils"><i class="icon-folder-open"></i>utils</a>
              </li>
            </ul>
            <ul id="package_utils" class="nav nav-list">
              <li><a href="../../modules/utils/AnimationUtils.html">AnimationUtils</a></li>
              <li><a href="../../modules/utils/AppInit.html">AppInit</a></li>
              <li><a href="../../modules/utils/Async.html">Async</a></li>
              <li><a href="../../modules/utils/BuildInfoUtils.html">BuildInfoUtils</a></li>
              <li><a href="../../modules/utils/CollectionUtils.html">CollectionUtils</a></li>
              <li><a href="../../modules/utils/ColorUtils.html">ColorUtils</a></li>
              <li><a href="../../modules/utils/DeprecationWarning.html">DeprecationWarning</a></li>
              <li><a href="../../modules/utils/DragAndDrop.html">DragAndDrop</a></li>
              <li><a href="../../modules/utils/DropdownEventHandler.html">DropdownEventHandler</a></li>
              <li><a href="../../modules/utils/ExtensionLoader.html">ExtensionLoader</a></li>
              <li><a href="../../modules/utils/ExtensionUtils.html">ExtensionUtils</a></li>
              <li><a href="../../modules/utils/Global.html">Global</a></li>
              <li><a href="../../modules/utils/KeyEvent.html">KeyEvent</a></li>
              <li><a href="../../modules/utils/NativeApp.html">NativeApp</a></li>
              <li><a href="../../modules/utils/NodeConnection.html">NodeConnection</a></li>
              <li><a href="../../modules/utils/NodeDomain.html">NodeDomain</a></li>
              <li><a href="../../modules/utils/PerfUtils.html">PerfUtils</a></li>
              <li><a href="../../modules/utils/Resizer.html">Resizer</a></li>
              <li><a href="../../modules/utils/ShellAPI.html">ShellAPI</a></li>
              <li><a href="../../modules/utils/StringMatch.html">StringMatch</a></li>
              <li><a href="../../modules/utils/StringUtils.html">StringUtils</a></li>
              <li><a href="../../modules/utils/TokenUtils.html">TokenUtils</a></li>
              <li><a href="../../modules/utils/UpdateNotification.html">UpdateNotification</a></li>
              <li><a href="../../modules/utils/UrlParams.html">UrlParams</a></li>
              <li><a href="../../modules/utils/ValidationUtils.html">ValidationUtils</a></li>
              <li><a href="../../modules/utils/ViewUtils.html">ViewUtils</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_view"><i class="icon-folder-open"></i>view</a>
              </li>
            </ul>
            <ul id="package_view" class="nav nav-list">
              <li><a href="../../modules/view/PanelManager.html">PanelManager</a></li>
              <li><a href="../../modules/view/ViewCommandHandlers.html">ViewCommandHandlers</a></li>
            </ul>
                        <ul class="nav nav-list package-list">
              <li class="nav-header">
                <a href="javascript:;" class="toggle-package" data-package="package_widgets"><i class="icon-folder-open"></i>widgets</a>
              </li>
            </ul>
            <ul id="package_widgets" class="nav nav-list">
              <li><a href="../../modules/widgets/bootstrap-alerts.html">bootstrap-alerts</a></li>
              <li><a href="../../modules/widgets/bootstrap-button.html">bootstrap-button</a></li>
              <li><a href="../../modules/widgets/bootstrap-dropdown.html">bootstrap-dropdown</a></li>
              <li><a href="../../modules/widgets/bootstrap-modal.html">bootstrap-modal</a></li>
              <li><a href="../../modules/widgets/bootstrap-popover.html">bootstrap-popover</a></li>
              <li><a href="../../modules/widgets/bootstrap-scrollspy.html">bootstrap-scrollspy</a></li>
              <li><a href="../../modules/widgets/bootstrap-tab.html">bootstrap-tab</a></li>
              <li><a href="../../modules/widgets/bootstrap-tooltip.html">bootstrap-tooltip</a></li>
              <li><a href="../../modules/widgets/bootstrap-twipsy-mod.html">bootstrap-twipsy-mod</a></li>
              <li><a href="../../modules/widgets/DefaultDialogs.html">DefaultDialogs</a></li>
              <li><a href="../../modules/widgets/Dialogs.html">Dialogs</a></li>
              <li><a href="../../modules/widgets/DropdownButton.html">DropdownButton</a></li>
              <li><a href="../../modules/widgets/ModalBar.html">ModalBar</a></li>
              <li><a href="../../modules/widgets/PopUpManager.html">PopUpManager</a></li>
              <li><a href="../../modules/widgets/StatusBar.html">StatusBar</a></li>
            </ul>
            
          </div>
        </div>
        <div class="module span9">
          <section class="description">
            <h3>Description</h3>
            <div>
              <p>unittests: HTML Instrumentation</p>

            </div>
          </section>
    
          <section class="dependencies">
            <h3>Dependencies</h3>
            
            
            <span class="alert alert-info">This module has no dependencies</span>
            
          </section>
    
            <section class="variables">
              <h3>Variables 
                <label class="checkbox">
                  <input class="toggle-public" type="checkbox"> Show Private Members
                </label>
              </h3>
              
              <div class="member">
      
                <span class="pull-right scope">
                  
                  
                </span>
                <h4>newIndex</h4>
                <dl>
                </dl>
                <div class="description"><p>jslint continue: true</p>
</div>
                <button class="btn btn-small show-code">Show code</button>
                <pre class="language-javascript"><code class="language-javascript">var newIndex = 0,
            oldIndex = 0,
            newChildren = newParent.children,
            oldChildren = oldParent ? oldParent.children : [],
            newChild,
            oldChild,
            newEdits = [],
            newEdit,
            textAfterID,
            edits = [],
            moves = [],
            newElements = [];</code></pre>
              </div>
              
            </section>
    
          <section class="functions">
            <h3>Functions 
              <label class="checkbox">
                <input class="toggle-public" type="checkbox"> Show Private Members
              </label>
            </h3>
            
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>addEdits</h4>
              <div class="description"><p>Aggregates the child edits in the proper data structures.</p>
</div>
              <dl>
                  <dt>delta</dt>
                  <dd class="label label-info pull-left">Object</dd>
                  <dd>edits, moves and newElements to add</dd>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var addEdits = function (delta) {
            edits.push.apply(edits, delta.edits);
            moves.push.apply(moves, delta.moves);
            queue.push.apply(queue, delta.newElements);
        };
        
        &#x2F;&#x2F; Start at the root of the current tree.
        queue.push(newNode);
        
        do {
            newElement = queue.pop();
            oldElement = oldNodeMap[newElement.tagID];
            
            &#x2F;&#x2F; Do we need to compare elements?
            if (oldElement) {
                
                &#x2F;&#x2F; Are attributes different?
                if (newElement.attributeSignature !== oldElement.attributeSignature) {
                    &#x2F;&#x2F; generate attribute edits
                    edits.push.apply(edits, generateAttributeEdits(oldElement, newElement));
                }
                
                &#x2F;&#x2F; Has there been a change to this node&#39;s immediate children?
                if (newElement.childSignature !== oldElement.childSignature) {
                    addEdits(generateChildEdits(oldElement, oldNodeMap, newElement, newNodeMap));
                }
                
                &#x2F;&#x2F; If there&#39;s a change farther down in the tree, add the children to the queue.
                &#x2F;&#x2F; If not, we can skip that whole subtree.
                if (newElement.subtreeSignature !== oldElement.subtreeSignature) {
                    newElement.children.forEach(queuePush);
                }
            
            &#x2F;&#x2F; This is a new element, so go straight to generating child edits (which will
            &#x2F;&#x2F; create the appropriate Insert edits).
            } else {
                &#x2F;&#x2F; If this is the root (html) tag, we need to manufacture an insert for it here,
                &#x2F;&#x2F; because it isn&#39;t the child of any other node. The browser-side code doesn&#39;t
                &#x2F;&#x2F; care about parentage&#x2F;positioning in this case, and will handle just setting the 
                &#x2F;&#x2F; ID on the existing implied HTML tag in the browser without actually creating it.
                if (!newElement.parent) {
                    edits.push({
                        type: &quot;elementInsert&quot;,
                        tag: newElement.tag,
                        tagID: newElement.tagID,
                        parentID: null,
                        attributes: newElement.attributes
                    });
                }
                
                addEdits(generateChildEdits(null, oldNodeMap, newElement, newNodeMap));
            }
        } while (queue.length);
        
        &#x2F;&#x2F; Special handling for moves: add edits to the beginning of the list so that
        &#x2F;&#x2F; moved nodes are set aside to ensure that they remain available at the time of their
        &#x2F;&#x2F; move.
        if (moves.length &gt; 0) {
            edits.unshift({
                type: &quot;rememberNodes&quot;,
                tagIDs: moves
            });
        }
        
        return edits;
    }
    
    &#x2F;&#x2F; Public API
    exports.domdiff = domdiff;
});</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>addElementDelete</h4>
              <div class="description"><p>If the old element that we&#39;re looking at does not appear in the new
DOM, that means it was deleted and we&#39;ll create an elementDelete edit.</p>
<p>If the element is in the new DOM, then this will return false and
the main loop with either spot this node later on or the element
has been moved.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var addElementDelete = function () {
            if (!newNodeMap[oldChild.tagID]) {
                &#x2F;&#x2F; We can finalize existing edits relative to this node *before* it&#39;s
                &#x2F;&#x2F; deleted.
                finalizeNewEdits(oldChild.tagID, true);
                
                newEdit = {
                    type: &quot;elementDelete&quot;,
                    tagID: oldChild.tagID
                };
                newEdits.push(newEdit);
                
                &#x2F;&#x2F; deleted element means we need to move on to compare the next
                &#x2F;&#x2F; of the old tree with the one from the current tree that we
                &#x2F;&#x2F; just compared
                oldIndex++;
                return true;
            }
            return false;
        };</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>addElementInsert</h4>
              <div class="description"><p>If the current element was not in the old DOM, then we will create
an elementInsert edit for it.</p>
<p>If the element was in the old DOM, this will return false and the
main loop will either spot this element later in the child list
or the element has been moved.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var addElementInsert = function () {
            if (!oldNodeMap[newChild.tagID]) {
                newEdit = {
                    type: &quot;elementInsert&quot;,
                    tag: newChild.tag,
                    tagID: newChild.tagID,
                    parentID: newChild.parent.tagID,
                    attributes: newChild.attributes
                };
                
                newEdits.push(newEdit);
                
                &#x2F;&#x2F; This newly inserted node needs to have edits generated for its
                &#x2F;&#x2F; children, so we add it to the queue.
                newElements.push(newChild);
                
                &#x2F;&#x2F; A textInsert edit that follows this elementInsert should use
                &#x2F;&#x2F; this element&#39;s ID.
                textAfterID = newChild.tagID;
                
                &#x2F;&#x2F; new element means we need to move on to compare the next
                &#x2F;&#x2F; of the current tree with the one from the old tree that we
                &#x2F;&#x2F; just compared
                newIndex++;
                return true;
            }
            return false;
        };</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>addElementMove</h4>
              <div class="description"><p>Adds an elementMove edit if the parent has changed between the old and new trees. 
These are fairly infrequent and generally occur if you make a change across 
tag boundaries.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var addElementMove = function () {
            
            &#x2F;&#x2F; This check looks a little strange, but it suits what we&#39;re trying
            &#x2F;&#x2F; to do: as we&#39;re walking through the children, a child node that has moved
            &#x2F;&#x2F; from one parent to another will be found but would look like some kind
            &#x2F;&#x2F; of insert. The check that we&#39;re doing here is looking up the current
            &#x2F;&#x2F; child&#39;s ID in the *old* map and seeing if this child used to have a 
            &#x2F;&#x2F; different parent.
            var possiblyMovedElement = oldNodeMap[newChild.tagID];
            if (possiblyMovedElement &amp;&amp;
                    newParent.tagID !== getParentID(possiblyMovedElement)) {
                newEdit = {
                    type: &quot;elementMove&quot;,
                    tagID: newChild.tagID,
                    parentID: newChild.parent.tagID
                };
                moves.push(newEdit.tagID);
                newEdits.push(newEdit);
                
                &#x2F;&#x2F; this element in the new tree was a move to this spot, so we can move
                &#x2F;&#x2F; on to the next child in the new tree.
                newIndex++;
                return true;
            }
            return false;
        };</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>addTextDelete</h4>
              <div class="description"><p>Adds a textDelete edit for text node that is not in the new tree.
Note that we actually create a textReplace rather than a textDelete
if the previous node in current tree was a text node. We do this because
text nodes are not individually addressable and a delete event would
end up clearing out both that previous text node that we want to keep
and this text node that we want to eliminate. Instead, we just log
a textReplace which will result in the deletion of this node and
the maintaining of the old content.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var addTextDelete = function () {
            var prev = prevNode();
            if (prev &amp;&amp; !prev.children) {
                newEdit = {
                    type: &quot;textReplace&quot;,
                    content: prev.content
                };
            } else {
                newEdit = {
                    type: &quot;textDelete&quot;
                };
            }
            
            &#x2F;&#x2F; When elements are deleted or moved from the old set of children, you
            &#x2F;&#x2F; can end up with multiple text nodes in a row. A single textReplace edit
            &#x2F;&#x2F; will take care of those (and will contain all of the right content since
            &#x2F;&#x2F; the text nodes between elements in the new DOM are merged together).
            &#x2F;&#x2F; The check below looks to see if we&#39;re already in the process of adding
            &#x2F;&#x2F; a textReplace edit following the same element.
            var previousEdit = newEdits.length &gt; 0 &amp;&amp; newEdits[newEdits.length - 1];
            if (previousEdit &amp;&amp; previousEdit.type === &quot;textReplace&quot; &amp;&amp;
                    previousEdit.afterID === textAfterID) {
                oldIndex++;
                return;
            }
            
            newEdit.parentID = oldChild.parent.tagID;
            
            &#x2F;&#x2F; If there was only one child previously, we just pass along
            &#x2F;&#x2F; textDelete&#x2F;textReplace with the parentID and the browser will
            &#x2F;&#x2F; clear all of the children
            if (oldChild.parent.children.length === 1) {
                newEdits.push(newEdit);
            } else {
                if (textAfterID) {
                    newEdit.afterID = textAfterID;
                }
                newEdits.push(newEdit);
            }
            
            &#x2F;&#x2F; This text appeared in the old tree but not the new one, so we
            &#x2F;&#x2F; increment the old children counter.
            oldIndex++;
        };</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>addTextInsert</h4>
              <div class="description"><p>Adds a textInsert edit for a newly created text node.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var addTextInsert = function () {
            newEdit = {
                type: &quot;textInsert&quot;,
                content: newChild.content,
                parentID: newChild.parent.tagID
            };
            
            &#x2F;&#x2F; text changes will generally have afterID and beforeID, but we make
            &#x2F;&#x2F; special note if it&#39;s the first child.
            if (textAfterID) {
                newEdit.afterID = textAfterID;
            } else {
                newEdit.firstChild = true;
            }
            newEdits.push(newEdit);
            
            &#x2F;&#x2F; The text node is in the new tree, so we move to the next new tree item
            newIndex++;
        };</code></pre>
            </div>
            <div class="member public">
              <span class="pull-right scope">
                
                Public API
              </span>
              <h4>domdiff</h4>
              <div class="description"><p>Generate a list of edits that will mutate oldNode to look like newNode.
Currently, there are the following possible edit operations:</p>
<ul>
<li>elementInsert</li>
<li>elementDelete</li>
<li>elementMove</li>
<li>textInsert</li>
<li>textDelete</li>
<li>textReplace</li>
<li>attrDelete</li>
<li>attrChange</li>
<li>attrAdd</li>
<li>rememberNodes (a special instruction that reflects the need to hang on to moved nodes)</li>
</ul>
</div>
              <dl>
                  <dt>oldNode</dt>
                  <dd class="label label-info pull-left">Object</dd>
                  <dd>SimpleDOM node with the original content</dd>
                  <dt>newNode</dt>
                  <dd class="label label-info pull-left">Object</dd>
                  <dd>SimpleDOM node with the new content</dd>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">function domdiff(oldNode, newNode) {
        var queue = [],
            edits = [],
            moves = [],
            newElement,
            oldElement,
            oldNodeMap = oldNode ? oldNode.nodeMap : {},
            newNodeMap = newNode.nodeMap;</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>finalizeNewEdits</h4>
              <div class="description"><p>We initially put new edit objects into the <code>newEdits</code> array so that we
can fix them up with proper positioning information. This function is
responsible for doing that fixup.</p>
<p>The <code>beforeID</code> that appears in many edits tells the browser to make the
change before the element with the given ID. In other words, an
elementInsert with a <code>beforeID</code> of 32 would result in something like
<code>parentElement.insertBefore(newChildElement, _queryBracketsID(32))</code></p>
<p>Many new edits are captured in the <code>newEdits</code> array so that a suitable
<code>beforeID</code> can be added to them before they are added to the main edits
list. This function sets the <code>beforeID</code> on any pending edits and adds
them to the main list.</p>
<p>If this item is not being deleted, then it will be used as the <code>afterID</code>
for text edits that follow.</p>
</div>
              <dl>
                  <dt>beforeID</dt>
                  <dd class="label label-info pull-left">int</dd>
                  <dd>ID to set on the pending edits</dd>
                  <dt>isBeingDeleted</dt>
                  <dd class="label label-info pull-left">boolean</dd>
                  <dd>true if the given item is being deleted. If so,
 we can't use it as the `afterID` for future edits--whatever previous item
 was set as the `textAfterID` is still okay.</dd>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var finalizeNewEdits = function (beforeID, isBeingDeleted) {
            newEdits.forEach(function (edit) {
                &#x2F;&#x2F; elementDeletes don&#39;t need any positioning information
                if (edit.type !== &quot;elementDelete&quot;) {
                    edit.beforeID = beforeID;
                }
            });
            edits.push.apply(edits, newEdits);
            newEdits = [];
            
            &#x2F;&#x2F; If the item we made this set of edits relative to
            &#x2F;&#x2F; is being deleted, we can&#39;t use it as the afterID for future
            &#x2F;&#x2F; edits. It&#39;s okay to just keep the previous afterID, since
            &#x2F;&#x2F; this node will no longer be in the tree by the time we get
            &#x2F;&#x2F; to any future edit that needs an afterID.
            if (!isBeingDeleted) {
                textAfterID = beforeID;
            }
        };</code></pre>
            </div>
            <div class="member private">
              <span class="pull-right scope">
                Private
                
              </span>
              <h4>generateAttributeEdits</h4>
              <div class="description"><p>Determines the changes made to attributes and generates edits for those changes.</p>
</div>
              <dl>
                  <dt>oldNode</dt>
                  <dd class="label label-info pull-left">SimpleNode</dd>
                  <dd>node from old tree</dd>
                  <dt>newNode</dt>
                  <dd class="label label-info pull-left">SimpleNode</dd>
                  <dd>node from new tree</dd>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">function generateAttributeEdits(oldNode, newNode) {
        &#x2F;&#x2F; shallow copy the old attributes object so that we can modify it
        var oldAttributes = $.extend({}, oldNode.attributes),
            newAttributes = newNode.attributes,
            edits = [];
        
        Object.keys(newAttributes).forEach(function (attributeName) {
            if (oldAttributes[attributeName] !== newAttributes[attributeName]) {
                var type = oldAttributes.hasOwnProperty(attributeName) ? &quot;attrChange&quot; : &quot;attrAdd&quot;;
                edits.push({
                    type: type,
                    tagID: oldNode.tagID,
                    attribute: attributeName,
                    value: newAttributes[attributeName]
                });
            }
            delete oldAttributes[attributeName];
        });
        
        Object.keys(oldAttributes).forEach(function (attributeName) {
            edits.push({
                type: &quot;attrDelete&quot;,
                tagID: oldNode.tagID,
                attribute: attributeName
            });
        });
        
        return edits;
    }</code></pre>
            </div>
            <div class="member private">
              <span class="pull-right scope">
                Private
                
              </span>
              <h4>generateChildEdits</h4>
              <div class="description"><p>When the main loop (see below) determines that something has changed with
an element&#39;s immediate children, it calls this function to create edit
operations for those changes.</p>
<p>This adds to the edit list in place and does not return anything.</p>
</div>
              <dl>
                  <dt>oldParent</dt>
                    <span class="label label-nullable pull-left">nullable</span>
                  <dd class="label label-info pull-left">Object</dd>
                  <dd>SimpleDOM node for the previous state of this element, null/undefined if the element is new</dd>
                  <dt>newParent</dt>
                  <dd class="label label-info pull-left">Object</dd>
                  <dd>SimpleDOM node for the current state of the element</dd>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var generateChildEdits = function (oldParent, oldNodeMap, newParent, newNodeMap) {</code></pre>
            </div>
            <div class="member private">
              <span class="pull-right scope">
                Private
                
              </span>
              <h4>getParentID</h4>
              <div class="description"><p>Retrieve the parent tag ID of a SimpleDOM node.</p>
</div>
              <dl>
                  <dt>node</dt>
                  <dd class="label label-info pull-left">Object</dd>
                  <dd>SimpleDOM node for which to look up parent ID</dd>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">function getParentID(node) {
        return node.parent &amp;&amp; node.parent.tagID;
    }</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>hasMoved</h4>
              <div class="description"><p>Looks to see if the element in the old tree has moved by checking its
current and former parents.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var hasMoved = function (oldChild) {
            var oldChildInNewTree = newNodeMap[oldChild.tagID];
            
            return oldChild.children &amp;&amp; oldChildInNewTree &amp;&amp; getParentID(oldChild) !== getParentID(oldChildInNewTree);
        };
        
        &#x2F;&#x2F; Loop through the current and old children, comparing them one by one.
        while (newIndex &lt; newChildren.length &amp;&amp; oldIndex &lt; oldChildren.length) {
            newChild = newChildren[newIndex];
            
            &#x2F;&#x2F; Check to see if the currentChild has been reparented from somewhere 
            &#x2F;&#x2F; else in the old tree
            if (newChild.children &amp;&amp; addElementMove()) {
                continue;
            }
            
            oldChild = oldChildren[oldIndex];
            
            &#x2F;&#x2F; Check to see if the oldChild has been moved to another parent.
            &#x2F;&#x2F; If it has, we deal with it on the other side (see above)
            if (hasMoved(oldChild)) {
                oldIndex++;
                continue;
            }
            
            if (newChild.isElement() || oldChild.isElement()) {
                
                if (newChild.isElement() &amp;&amp; oldChild.isText()) {
                    addTextDelete();
                    
                    &#x2F;&#x2F; If this element is new, add it and move to the next child
                    &#x2F;&#x2F; in the current tree. Otherwise, we&#39;ll compare this same
                    &#x2F;&#x2F; current element with the next old element on the next pass
                    &#x2F;&#x2F; through the loop.
                    addElementInsert();
                
                } else if (oldChild.isElement() &amp;&amp; newChild.isText()) {
                    &#x2F;&#x2F; If the old child has *not* been deleted, we assume that we&#39;ve
                    &#x2F;&#x2F; inserted some text and will still encounter the old node
                    if (!addElementDelete()) {
                        addTextInsert();
                    }
                
                &#x2F;&#x2F; both children are elements
                } else {
                    if (newChild.tagID !== oldChild.tagID) {
                        
                        &#x2F;&#x2F; First, check to see if we&#39;re deleting an element.
                        &#x2F;&#x2F; If we are, get rid of that element and restart our comparison
                        &#x2F;&#x2F; logic with the same element from the new tree and the next one
                        &#x2F;&#x2F; from the old tree.
                        if (!addElementDelete()) {
                            &#x2F;&#x2F; Since we&#39;re not deleting and these elements don&#39;t match up, we
                            &#x2F;&#x2F; must have a new element. Add an elementInsert (and log a problem
                            &#x2F;&#x2F; if no insert works.)
                            if (!addElementInsert()) {
                                console.error(&quot;HTML Instrumentation: This should not happen. Two elements have different tag IDs and there was no insert&#x2F;delete. This generally means there was a reordering of elements.&quot;);
                                newIndex++;
                                oldIndex++;
                            }
                        }
                    
                    &#x2F;&#x2F; There has been no change in the tag we&#39;re looking at.
                    } else {
                        &#x2F;&#x2F; Since this element hasn&#39;t moved, it is a suitable &quot;beforeID&quot;
                        &#x2F;&#x2F; for the edits we&#39;ve logged.
                        finalizeNewEdits(oldChild.tagID, false);
                        newIndex++;
                        oldIndex++;
                    }
                }
            
            &#x2F;&#x2F; We know we&#39;re comparing two texts. Just match up their signatures.
            } else {
                if (newChild.textSignature !== oldChild.textSignature) {
                    newEdit = {
                        type: &quot;textReplace&quot;,
                        content: newChild.content,
                        parentID: newChild.parent.tagID
                    };
                    if (textAfterID) {
                        newEdit.afterID = textAfterID;
                    }
                    newEdits.push(newEdit);
                }
                
                &#x2F;&#x2F; Either we&#39;ve done a text replace or both sides matched. In either
                &#x2F;&#x2F; case we&#39;re ready to move forward among both the old and new children.
                newIndex++;
                oldIndex++;
            }
        }
        
        &#x2F;&#x2F; At this point, we&#39;ve used up all of the children in at least one of the
        &#x2F;&#x2F; two sets of children.</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>prevNode</h4>
              <div class="description"><p>Finds the previous child of the new tree.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var prevNode = function () {
            if (newIndex &gt; 0) {
                return newParent.children[newIndex - 1];
            }
            return null;
        };</code></pre>
            </div>
            <div class="member">
              <span class="pull-right scope">
                
                
              </span>
              <h4>queuePush</h4>
              <div class="description"><p>Adds elements to the queue for generateChildEdits.
Only elements (and not text nodes) are added. New nodes (ones that aren&#39;t in the
old nodeMap), are not added here because they will be added when generateChildEdits
creates the elementInsert edit.</p>
</div>
              <dl>
              </dl>
              <button class="btn btn-small show-code">Show code</button>
              <pre class="language-javascript"><code class="language-javascript">var queuePush = function (node) {
            if (node.children &amp;&amp; oldNodeMap[node.tagID]) {
                queue.push(node);
            }
        };</code></pre>
            </div>
            
          </section>
          
          
        </div>
      </div>
    </div>

    <script type="text/javascript" src="../../assets/js/prism.js"></script>
  </body>
</html>